(this.webpackJsonptodomvc=this.webpackJsonptodomvc||[]).push([[0],{86:function(e,t,n){"use strict";n.r(t),n.d(t,"yDoc",(function(){return we})),n.d(t,"rtc",(function(){return Se}));var r={};n.r(r),n.d(r,"addTodo",(function(){return D})),n.d(r,"deleteTodo",(function(){return N})),n.d(r,"editTodo",(function(){return _})),n.d(r,"completeTodo",(function(){return k})),n.d(r,"completeAllTodos",(function(){return A})),n.d(r,"clearCompleted",(function(){return I})),n.d(r,"setVisibilityFilter",(function(){return L}));var c,o=n(6),i=n(39),a=n(28),s=n(26),d=n(0),l=n(1),u=n(9),f=n(8),b=n(34),p=n.n(b),j=n(10),h=function(e){Object(u.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={text:e.props.text||""},e.handleSubmit=function(t){var n=t.target.value.trim();13===t.which&&(e.props.onSave(n),e.props.newTodo&&e.setState({text:""}))},e.handleChange=function(t){e.setState({text:t.target.value})},e.handleBlur=function(t){e.props.newTodo||e.props.onSave(t.target.value)},e}return Object(l.a)(n,[{key:"render",value:function(){return Object(j.jsx)("input",{className:p()({edit:this.props.editing,"new-todo":this.props.newTodo}),type:"text",placeholder:this.props.placeholder,autoFocus:!0,value:this.state.text,onBlur:this.handleBlur,onChange:this.handleChange,onKeyDown:this.handleSubmit})}}]),n}(o.Component),O=n(15),v={position:"absolute",padding:"0.5rem 1rem",transform:"translateX(calc(-100% - 1rem))",background:"#fff",boxShadow:"0 3px 6px rgba(0, 0, 0, 0.1)",borderRadius:"3px",fontWeight:500},m=function(){var e=Object(o.useState)(Se.connected),t=Object(O.a)(e,2),n=t[0],r=t[1];return Object(j.jsx)("button",{style:v,onClick:function(){n?Se.disconnect():Se.connect(),r(!n)},children:n?"Disable Sync":"Enable Sync"})},g=function(e){var t=e.addTodo;return Object(j.jsxs)("header",{className:"header",children:[Object(j.jsx)("h1",{children:"todos"}),Object(j.jsxs)("small",{style:{position:"absolute",top:"-40px",width:"100%",textAlign:"center"},children:["based on"," ",Object(j.jsx)("a",{href:"https://github.com/reduxjs/redux/tree/master/examples/todomvc",children:"https://github.com/reduxjs/redux/tree/master/examples/todomvc"})]}),Object(j.jsx)(m,{}),Object(j.jsx)(h,{newTodo:!0,onSave:function(e){0!==e.length&&t(e)},placeholder:"What needs to be done?"})]})},x="ADD_TODO",y="DELETE_TODO",w="EDIT_TODO",S="COMPLETE_TODO",C="COMPLETE_ALL_TODOS",T="CLEAR_COMPLETED",E="SET_VISIBILITY_FILTER",D=function(e){return{type:x,text:e}},N=function(e){return{type:y,id:e}},_=function(e,t){return{type:w,id:e,text:t}},k=function(e){return{type:S,id:e}},A=function(){return{type:C}},I=function(){return{type:T}},L=function(e){return{type:E,filter:e}},F=Object(s.b)(null,{addTodo:D})(g),R=n(7),U=function(e){var t=e.active,n=e.children,r=e.setFilter;return Object(j.jsx)("a",{className:p()({selected:t}),style:{cursor:"pointer"},onClick:function(){return r()},children:n})},M=Object(s.b)((function(e,t){return{active:t.filter===e.visibilityFilter}}),(function(e,t){return{setFilter:function(){e(L(t.filter))}}}))(U),B="show_all",Y="show_completed",J="show_active",G=(c={},Object(R.a)(c,B,"All"),Object(R.a)(c,J,"Active"),Object(R.a)(c,Y,"Completed"),c),P=function(e){var t=e.activeCount,n=e.completedCount,r=e.onClearCompleted,c=1===t?"item":"items";return Object(j.jsxs)("footer",{className:"footer",children:[Object(j.jsxs)("span",{className:"todo-count",children:[Object(j.jsx)("strong",{children:t||"No"})," ",c," left"]}),Object(j.jsx)("ul",{className:"filters",children:Object.keys(G).map((function(e){return Object(j.jsx)("li",{children:Object(j.jsx)(M,{filter:e,children:G[e]})},e)}))}),!!n&&Object(j.jsx)("button",{className:"clear-completed",onClick:r,children:"Clear completed"})]})},V=n(16),X=function(e){Object(u.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={editing:!1},e.handleDoubleClick=function(){e.setState({editing:!0})},e.handleSave=function(t,n){0===n.length?e.props.deleteTodo(t):e.props.editTodo(t,n),e.setState({editing:!1})},e}return Object(l.a)(n,[{key:"render",value:function(){var e,t=this,n=this.props,r=n.todo,c=n.completeTodo,o=n.deleteTodo;return e=this.state.editing?Object(j.jsx)(h,{text:r.text,editing:this.state.editing,onSave:function(e){return t.handleSave(r.id,e)}}):Object(j.jsxs)("div",{className:"view",children:[Object(j.jsx)("input",{className:"toggle",type:"checkbox",checked:r.completed,onChange:function(){return c(r.id)}}),Object(j.jsx)("label",{onDoubleClick:this.handleDoubleClick,children:r.text}),Object(j.jsx)("button",{className:"destroy",onClick:function(){return o(r.id)}})]}),Object(j.jsx)("li",{className:p()({completed:r.completed,editing:this.state.editing}),children:e})}}]),n}(o.Component),H=function(e){var t=e.filteredTodos,n=e.actions;return Object(j.jsx)("ul",{className:"todo-list",children:t.sort((function(e,t){return e.createdAt-t.createdAt})).map((function(e){return Object(j.jsx)(X,Object(V.a)({todo:e},n),e.id)}))})},W=n(45),K=function(e){return Object.values(e.todos)},q=Object(W.a)([function(e){return e.visibilityFilter},K],(function(e,t){switch(e){case B:return t;case Y:return t.filter((function(e){return e.completed}));case J:return t.filter((function(e){return!e.completed}));default:throw new Error("Unknown filter: "+e)}})),z=Object(W.a)([K],(function(e){return e.reduce((function(e,t){return t.completed?e+1:e}),0)})),Q=Object(s.b)((function(e){return{filteredTodos:q(e)}}),(function(e){return{actions:Object(a.a)(r,e)}}))(H),Z=function(e){var t=e.todosCount,n=e.completedCount,r=e.actions;return Object(j.jsxs)("section",{className:"main",children:[!!t&&Object(j.jsxs)("span",{children:[Object(j.jsx)("input",{className:"toggle-all",type:"checkbox",checked:n===t,readOnly:!0}),Object(j.jsx)("label",{onClick:r.completeAllTodos})]}),Object(j.jsx)(Q,{}),!!t&&Object(j.jsx)(P,{completedCount:n,activeCount:t-n,onClearCompleted:r.clearCompleted})]})},$=Object(s.b)((function(e){return{todosCount:Object.keys(e.todos).length,completedCount:z(e)}}),(function(e){return{actions:Object(a.a)(r,e)}}))(Z),ee=function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)(F,{}),Object(j.jsx)($,{})]})},te=n(52),ne=n(57),re=n(91),ce={initialTodo:{id:"initialTodo",text:"Use Redux",completed:!1,createdAt:1404e9}};var oe,ie,ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;return t.type===E?t.filter:e},se=n(20),de=n(53),le=function(e){return"[object Object]"===Object.prototype.toString.call(e)},ue=function(e){return Array.isArray(e)},fe=function(e){return"string"==typeof e||e instanceof String},be=function(e){return Number.isInteger(e)},pe=function e(t){if(ue(t)){var n=new se.a,r=t.map((function(t){return e(t)}));return n.push(r),n}if(le(t)){var c=new se.c;return Object.entries(t).forEach((function(t){c.set(t[0],e(t[1]))})),c}return t};(ie=oe||(oe={})).Add="add",ie.Update="update",ie.Delete="delete";var je,he,Oe=function e(t,n,r,c){if(0===r.length)throw new Error("Cannot traverse 0 length path.");if(1===r.length)!function(e,t,n,r){if(t===oe.Add||t===oe.Update){var c=pe(r);if(e instanceof se.a&&be(n))t===oe.Update&&e.delete(n),e.insert(n,[c]);else{if(!(e instanceof se.c&&fe(n)))throw new Error("Unsupported YAbstractType or property type did not match.");e.set(n,c)}}else if(t===oe.Delete)if(e instanceof se.a&&be(n)){var o=(a=e.length-1,(i=n)<0?0:i>a?a:i);e.delete(o)}else{if(!(e instanceof se.c&&fe(n)))throw new Error("Unsupported YAbstractType or property type did not match.");e.delete(n)}var i,a}(t,n,r[0],c);else{var o=r[0],i=r.slice(1);if(t instanceof se.a){if(!be(o))throw new Error("States diverged.");var a=t.get(o);if(!(a instanceof se.c||a instanceof se.a))throw new Error("States diverged.");e(a,n,i,c)}else if(t instanceof se.c){if(!fe(o))throw new Error("States diverged.");var s=t.get(o);if(!(s instanceof se.c||s instanceof se.a))throw new Error("States diverged.");e(s,n,i,c)}else console.warn("Encountered unsupported yType. Received:",t)}},ve=function(e,t,n,r){Object(de.getDiff)(n,r).forEach((function(n){var r=n.val;Oe(e,n.op,[t].concat(n.path||[]),r)}))},me=Object(a.b)({todos:function(e){return function(t,n){return"YJS_INCOMING_CHANGES"===(null==n?void 0:n.type)?void 0===n.payload?t:n.payload:e(t,n)}}((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:var n=Object(re.a)();return Object(V.a)(Object(V.a)({},e),{},Object(R.a)({},n,{id:n,createdAt:(new Date).getTime(),completed:!1,text:t.text}));case y:var r=t.id,c=(e[r],Object(te.a)(e,[r].map(ne.a)));return c;case w:var o=e[t.id];return Object(V.a)(Object(V.a)({},e),{},Object(R.a)({},t.id,Object(V.a)(Object(V.a)({},o),{},{text:t.text})));case S:var i=e[t.id];return Object(V.a)(Object(V.a)({},e),{},Object(R.a)({},t.id,Object(V.a)(Object(V.a)({},i),{},{completed:!i.completed})));case C:var a=Object.values(e).every((function(e){return e.completed}));return Object.fromEntries(Object.entries(e).map((function(e){var t=Object(O.a)(e,2),n=t[0],r=t[1];return[n,Object(V.a)(Object(V.a)({},r),{},{completed:!a})]})));case T:return Object.fromEntries(Object.entries(e).filter((function(e){return!1===Object(O.a)(e,2)[1].completed})));default:return e}})),visibilityFilter:ae}),ge=me,xe=(n(71),n(56)),ye=function(){function e(t){Object(d.a)(this,e),this.connected=!1,this.yDoc=t,"false"!==window.localStorage.getItem("rtcSyncEnabled")&&this.connect()}return Object(l.a)(e,[{key:"connect",value:function(){this.provider?this.provider.connect():this.provider=new xe.a("redux-yjs-bindings",this.yDoc,{signaling:["wss://signaling.yjs.dev","wss://y-webrtc-signaling-eu.herokuapp.com"]}),window.localStorage.setItem("rtcSyncEnabled","true"),this.connected=!0}},{key:"disconnect",value:function(){this.provider&&this.provider.disconnect(),window.localStorage.setItem("rtcSyncEnabled","false"),this.connected=!1}}]),e}(),we=new se.b,Se=new ye(we),Ce=Object(a.c)(ge,null===(je=(he=window).__REDUX_DEVTOOLS_EXTENSION__)||void 0===je?void 0:je.call(he));!function(e,t,n){var r=e.getMap("__ReduxYjsBindingsRootMap"),c=t.getState()[n];le(c)&&Object(se.g)(e,(function(){r.set(n,pe({})),ve(r,n,{},c)})),ue(c)&&Object(se.g)(e,(function(){r.set(n,pe([])),ve(r,n,[],c)}));var o=!1,i=!1,a=t.getState()[n],s=t.subscribe((function(){var c=a;a=t.getState()[n],i||(o=!0,Object(se.g)(e,(function(){ve(r,n,c,a)})),o=!1)})),d=function(){o||(i=!0,function(e,t,n){e.dispatch({type:"YJS_INCOMING_CHANGES",payload:t.toJSON()[n]})}(t,r,n),i=!1)};r.observeDeep(d)}(we,Ce,"todos"),Object(i.render)(Object(j.jsx)(s.a,{store:Ce,children:Object(j.jsx)(ee,{})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.d4bf6196.chunk.js.map